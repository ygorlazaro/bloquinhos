LightboxOptions=Object.extend({fileLoadingImage:"img/loading.gif",fileBottomNavCloseImage:"img/closelabel.gif",overlayOpacity:.8,animate:!0,resizeSpeed:7,borderSize:10,labelImage:"Image",labelOf:"of"},window.LightboxOptions||{});var Lightbox=Class.create();Lightbox.prototype={imageArray:[],activeImage:undefined,initialize:function(){var n,t,i;this.updateImageList();this.keyboardAction=this.keyboardAction.bindAsEventListener(this);LightboxOptions.resizeSpeed>10&&(LightboxOptions.resizeSpeed=10);LightboxOptions.resizeSpeed<1&&(LightboxOptions.resizeSpeed=1);this.resizeDuration=LightboxOptions.animate?(11-LightboxOptions.resizeSpeed)*.15:0;this.overlayDuration=LightboxOptions.animate?.2:0;n=(LightboxOptions.animate?250:1)+"px";t=$$("body")[0];t.appendChild(Builder.node("div",{id:"overlay"}));t.appendChild(Builder.node("div",{id:"lightbox"},[Builder.node("div",{id:"outerImageContainer"},Builder.node("div",{id:"imageContainer"},[Builder.node("img",{id:"lightboxImage"}),Builder.node("div",{id:"hoverNav"},[Builder.node("a",{id:"prevLink",href:"#"}),Builder.node("a",{id:"nextLink",href:"#"})]),Builder.node("div",{id:"loading"},Builder.node("a",{id:"loadingLink",href:"#"},Builder.node("img",{src:LightboxOptions.fileLoadingImage})))])),Builder.node("div",{id:"imageDataContainer"},Builder.node("div",{id:"imageData"},[Builder.node("div",{id:"imageDetails"},[Builder.node("span",{id:"caption"}),Builder.node("span",{id:"numberDisplay"})]),Builder.node("div",{id:"bottomNav"},Builder.node("a",{id:"bottomNavClose",href:"#"},Builder.node("img",{src:LightboxOptions.fileBottomNavCloseImage})))]))]));$("overlay").hide().observe("click",function(){this.end()}.bind(this));$("lightbox").hide().observe("click",function(n){n.element().id=="lightbox"&&this.end()}.bind(this));$("outerImageContainer").setStyle({width:n,height:n});$("prevLink").observe("click",function(n){n.stop();this.changeImage(this.activeImage-1)}.bindAsEventListener(this));$("nextLink").observe("click",function(n){n.stop();this.changeImage(this.activeImage+1)}.bindAsEventListener(this));$("loadingLink").observe("click",function(n){n.stop();this.end()}.bind(this));$("bottomNavClose").observe("click",function(n){n.stop();this.end()}.bind(this));i=this,function(){$w("overlay lightbox outerImageContainer imageContainer lightboxImage hoverNav prevLink nextLink loading loadingLink imageDataContainer imageData imageDetails caption numberDisplay bottomNav bottomNavClose").each(function(n){i[n]=$(n)})}.defer()},updateImageList:function(){this.updateImageList=Prototype.emptyFunction;document.observe("click",function(n){var t=n.findElement("a[rel^=lightbox]")||n.findElement("area[rel^=lightbox]");t&&(n.stop(),this.start(t))}.bind(this))},start:function(n){var i,t;if($$("select","object","embed").each(function(n){n.style.visibility="hidden"}),i=this.getPageSize(),$("overlay").setStyle({width:i[0]+"px",height:i[1]+"px"}),new Effect.Appear(this.overlay,{duration:this.overlayDuration,from:0,to:LightboxOptions.overlayOpacity}),this.imageArray=[],t=0,n.rel=="lightbox")this.imageArray.push([n.href,n.title]);else for(this.imageArray=$$(n.tagName+'[href][rel="'+n.rel+'"]').collect(function(n){return[n.href,n.title]}).uniq();this.imageArray[t][0]!=n.href;)t++;var r=document.viewport.getScrollOffsets(),u=r[1]+document.viewport.getHeight()/10,f=r[0];this.lightbox.setStyle({top:u+"px",left:f+"px"}).show();this.changeImage(t)},changeImage:function(n){this.activeImage=n;LightboxOptions.animate&&this.loading.show();this.lightboxImage.hide();this.hoverNav.hide();this.prevLink.hide();this.nextLink.hide();this.imageDataContainer.setStyle({opacity:.0001});this.numberDisplay.hide();var t=new Image;t.onload=function(){this.lightboxImage.src=this.imageArray[this.activeImage][0];this.resizeImageContainer(t.width,t.height)}.bind(this);t.src=this.imageArray[this.activeImage][0]},resizeImageContainer:function(n,t){var u=this.outerImageContainer.getWidth(),f=this.outerImageContainer.getHeight(),r=n+LightboxOptions.borderSize*2,e=t+LightboxOptions.borderSize*2,h=r/u*100,c=e/f*100,o=u-r,s=f-e,i;s!=0&&new Effect.Scale(this.outerImageContainer,c,{scaleX:!1,duration:this.resizeDuration,queue:"front"});o!=0&&new Effect.Scale(this.outerImageContainer,h,{scaleY:!1,duration:this.resizeDuration,delay:this.resizeDuration});i=0;s==0&&o==0&&(i=100,Prototype.Browser.IE&&(i=250)),function(){this.prevLink.setStyle({height:t+"px"});this.nextLink.setStyle({height:t+"px"});this.imageDataContainer.setStyle({width:r+"px"});this.showImage()}.bind(this).delay(i/1e3)},showImage:function(){this.loading.hide();new Effect.Appear(this.lightboxImage,{duration:this.resizeDuration,queue:"end",afterFinish:function(){this.updateDetails()}.bind(this)});this.preloadNeighborImages()},updateDetails:function(){this.imageArray[this.activeImage][1]!=""&&this.caption.update(this.imageArray[this.activeImage][1]).show();this.imageArray.length>1&&this.numberDisplay.update(LightboxOptions.labelImage+" "+(this.activeImage+1)+" "+LightboxOptions.labelOf+"  "+this.imageArray.length).show();new Effect.Parallel([new Effect.SlideDown(this.imageDataContainer,{sync:!0,duration:this.resizeDuration,from:0,to:1}),new Effect.Appear(this.imageDataContainer,{sync:!0,duration:this.resizeDuration})],{duration:this.resizeDuration,afterFinish:function(){var n=this.getPageSize();this.overlay.setStyle({height:n[1]+"px"});this.updateNav()}.bind(this)})},updateNav:function(){this.hoverNav.show();this.activeImage>0&&this.prevLink.show();this.activeImage<this.imageArray.length-1&&this.nextLink.show();this.enableKeyboardNav()},enableKeyboardNav:function(){document.observe("keydown",this.keyboardAction)},disableKeyboardNav:function(){document.stopObserving("keydown",this.keyboardAction)},keyboardAction:function(n){var t=n.keyCode,r,i;r=n.DOM_VK_ESCAPE?n.DOM_VK_ESCAPE:27;i=String.fromCharCode(t).toLowerCase();i.match(/x|o|c/)||t==r?this.end():i=="p"||t==37?this.activeImage!=0&&(this.disableKeyboardNav(),this.changeImage(this.activeImage-1)):(i=="n"||t==39)&&this.activeImage!=this.imageArray.length-1&&(this.disableKeyboardNav(),this.changeImage(this.activeImage+1))},preloadNeighborImages:function(){var n,t;this.imageArray.length>this.activeImage+1&&(n=new Image,n.src=this.imageArray[this.activeImage+1][0]);this.activeImage>0&&(t=new Image,t.src=this.imageArray[this.activeImage-1][0])},end:function(){this.disableKeyboardNav();this.lightbox.hide();new Effect.Fade(this.overlay,{duration:this.overlayDuration});$$("select","object","embed").each(function(n){n.style.visibility="visible"})},getPageSize:function(){var n,t,i,r;return window.innerHeight&&window.scrollMaxY?(n=window.innerWidth+window.scrollMaxX,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(n=document.body.scrollWidth,t=document.body.scrollHeight):(n=document.body.offsetWidth,t=document.body.offsetHeight),self.innerHeight?(i=document.documentElement.clientWidth?document.documentElement.clientWidth:self.innerWidth,r=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(i=document.body.clientWidth,r=document.body.clientHeight),pageHeight=t<r?r:t,pageWidth=n<i?n:i,[pageWidth,pageHeight]}};document.observe("dom:loaded",function(){new Lightbox});
/*
//# sourceMappingURL=lightbox.min.js.map
*/